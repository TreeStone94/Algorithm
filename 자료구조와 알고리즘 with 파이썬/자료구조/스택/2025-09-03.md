### 배열구조의 스택을 위한 데이터

배열은 요소들을 저장할 공간이고, 용량(capacity)은 이 공간의 크기로 한번만 들어지고 나면 고정되는 상수입니다. 상단을 위한 top은 인덱스를 저장하는 변수로, 가장 최근에 삽입된 요소의 위치를 가리키도록 하겠습니다.

```python
capacity = 10
array = [None] * capacity
top = -1
```

### 스택의 연산

- **공백 상태와 포화 상태 isEmpty()와 isFull 연산**
    
    스택이 비어 있는지 또는 가득 차 있는지는 top을 이용해 확인할 수 있습니다. 스택이 공백 일 때 top은 -1이고, 포화 상태면 top이 `capacity-1` 이 되는 것을 알 수 있습니다. 물론 검사 결과는 참(True)이나 거짓(False)이 될 것입니다. 
    
    ```python
    def isEmpty():
    	if top == -1:
    		return True
    	else:
    		return False
    		
    def isFull(): return top == capacity -1
    ```
    

- **새로운 요소 e를 삽입하는 push(e) 연산**
    
    삽입을 위해서는 먼저 top을 하나 증가 시켜야합니다. 다음에 그 위치에 삽입할 요소e를 복사하면 삽입이 완료됩니다. 그런데 이 삽입이 가능하려면 전제 조건이 있습니다. 포화 상태가 아니어야한다는 것입니다. 만약 스택이 포화 상태라면 오버플로 오류 상태가 되어 삽입은 불가능합니다. 따라서 push() 연산에서는 스택이 포화 상태가 아닌지를 검사해야합니다.
    
    ```python
    def push(e):
    	if not isFull():
    		top += 1
    		array[top] = e
    	else:
    		print("stack overflow")
    		exit()
    ```
    

- **상단 요소를 삭제하는 pop() 연산**
    
    삭제 연산이 가능하려면 스택에 최소한 하나 이상의 요소가 남아 있어야 합니다. 따라서 pop() 연산에서는 먼저 공백 상태를 검사해야 합니다. 공백이 아니면 top을 하나 감소 시키고, 이전 위치(top+1)의 요소를 반환하면 됩니다.
    
    만약 스택이 공백이라면 언더플로 오류가 발생합니다.
    
    ```python
    def pop():
    	if not isEmpty():
    		top -=1
    		return array[top+1]
    	else:
    		print("stack underflow")
    		exit()
    		
    ```
    

- **상단 요소를 들여다 보는 peek() 연산**
    
    peek()도 공백이 아니어야 가능한데, 단순히 top위치의 요소를 반환하면 됩니다.
    
    ```python
    def peek():
    	if not isEmpty():
    			return array[top]
    	else: pass
    ```
    

- **현재 스택 요소의 수를 반환하는 size() 연산**
    
    현재 스택의 요소 수는 top+1입니다.
    
    ```python
    def size(): return top+1
    ```
    

- **전역 변수와 함수 구현 방법의 문제점**
    
    이러한 스택 구현에는 여러 개의 스택이 동시에 필요한 문제에 사용할 수 없다는 것입니다. 전역 변수로 선언된 배열이 하나이므로 이 코드는 하나의 스택이 필요한 경우에만 사용할 수 있습니다.
    

### 스택을 클래스로 구현

자료구조는 함수를 기반으로 하는 절차적 프로그래밍보다는 클래스 기반으로 하는 **객체 지향 프로그래밍** 기법을 이용해 구현하는 것이 훨씬 좋습니다. 이것은 자료구조의 추상 자료형이 클래스 개념과 정확히 일치하기 때문입니다.

- **클래스의 선언과 멤버변수 초기화**
    
    파이썬에서는 클래스의 멤버변수들은 생성자(contructor)라는 이름으로 불리는 __init__() 함수에서 선언하고 초기화 합니다.
    
    ```python
    class ArrayStack:
    	def __init__(self, capacity):
    		self.capacity = capacity
    		self.array = [None] * self.capacity
    		self.top = -1
    ```
    
    생성자는 클래스의 객체가 만들어 질 때마다 자동으로 호출되는 함수입니다. 예를 들어, 다음 문장은 용량이 각각 20과 100인 ArrayStack 객체 s1과 s2를 생성하는데, 각 코드가 실행될 때 마다 생성자가 호출되어 스택의 데이터를 초기화 합니다.
    
    ```python
    s1 = ArrayStack(20)
    s2 = ArrayStack(100)
    ```
    
    C++이나 Java와는 다르게 파이썬에서는 생성자를 포함한 클래스의 모든 멤버함수의 첫 번째 매개변수로 스택 객체 자신을 나타내는 `self` 를 넣기로 약속되어 있습니다. 클래스의 모든 메서드에서 다른 메서드나 멤버 변수를 사용할때 반드시 `self` 을 추가해야합니다.
    
- **클래스의 연산**
    
    ```python
    	def isEmpty(self): return self.top == -1:
    			
    	def isFull(self): return self.top == self.capacity -1
    	
    	def push(self, e):
    		if not self.isFull():
    			self.top += 1
    			self.array[self.top] = e
    		else: pass
    		
    	def pop(self):
    		if not self.isEmpty():
    			self.top -=1
    			return self.array[self.top+1]
    		else: pass
    
    	def peek(self):
    		if not self.isEmpty():
    			return self.array[self.top]
    		else: pass
    	
    	def size(self): return self.top+1
    ```
    

### 스택 클래스의 사용

스택을 이용해 말을 거꾸로 뒤집는 프로그램을 만들어봅시다. 문자열을 입력받고, 입력된 문자들을 순서대로 스택에 모두 넣은 다음 하나씩 꺼내서 출력하기만 하면 됩니다.

```python
s = ArrayStack(100)

msg = input()
for c in msg:
	s.push(c)

while not s.isEmpty():
	print(s.pop(), end='')

print()
```

## 스택의 응용:괄호 검사

프로그램 코드나 HTML 문서 등에서는 여러 가지 종류의 괄호들이 사용됩니다. 예를 들어, C언어에서는 대괄호 [], 중괄호 {}, 소괄호 ()가 사용되는데, 프로그램이 정상적으로 컴파일되려면 괄호들이 반드시 쌍이 되도록 사용되어야 합니다. 

**괄호 검사 문제**란 소스코드나 주어진 문자열에서 괄호들이 올바르게 사용되었는지를 검사하는 문제입니다. 그렇다면 올바른 괄호 사용을 위한 조건들에는 어떤 것이 있을까요?

- 조건1: 왼쪽 괄호의 개수와 오른쪽 괄호의 개수가 같아야 합니다.
- 조건2: 같은 종류인 경우 왼쪽 괄호가 오른쪽 괄호보다 먼저 나와야 합니다.
- 조건3: 다른 종류의 괄호의 쌍이 서로 교차하면 안됩니다.


### 괄호 검사 알고리즘

앞의 문자열들을 자세히 살펴보면 자세히 살펴보면 가장 가까운 괄호들끼리는 서로 쌍을 이루어야 하고, 쌍을 이룬 괄호들은 더 이상 고려할 필요가 없다는 것을 알 수 있습니다. 이러한 괄호 검사를 위해 스택이 사용되는데, 검사 과정을 다음과 같습니다.

- 빈 스택을 준비
- 입력한 문자를 하나씩 읽어 왼쪽 괄호를 만나면 스택에 삽입
- 오른쪽 괄호를 만나면 가장 최근에 삽입된 괄호를 스택에서 꺼냅니다. 이때 스택이 비어 있다면 오른쪽 괄호가 먼저 나온 상황이므로 조건2에 위배
- 꺼낸 괄호가 오른쪽 괄호와 짝이 맞지 않다면 조건3에 위배
- 입력 문자열을 끝까지 처리했는데 스택에 괄호가 남아 있다면 괄호의 개수가 맞지 않으므로 조건 1위배.
- 모든 문자를 처리하고 스택이 공백이면 검사 성공


### 괄호 검사 프로그램

```python
def checkBrackets(statement):
	stack = ArrayStack(100)
	for ch in statement:
		if ch in ('(', '{', '['):
			stack.push(ch)
		elif ch in (')', '}', ']'):
			if stack.isEmpty():
				return False
			else: 
				left = stack.pop()
				if ch == '(' and left != ')':
					return False
				elif ch == '{' and left != '}':
					return False
				elif ch == '[' and left != ']':
					return False
	
	return stack.isEmpty()
```

## 파이썬에서 스택 사용하기

스택 클래스를 직접 만들어 사용할 수 있지만, 더 빠른 해결책이 있습니다. 파이썬에서 제공하는 것들을 이용하는 방법입니다.

### 파이썬 리스트를 스택으로 사용하기

가장 간단한 방법은 파이썬 리스트를 스택처럼 사용하는 것입니다. 즉, 리스트의 앞쪽이나 뒤쪽을 스택의 상단으로 생각하고, 그쪽으로만 자료를 넣거나 빼는 것입니다. 이때 리스트의 뒤쪽을 스택 상단으로 사용하는 것이 더 효율적입니다. 


```python
s = list()

msg = input()
for c in msg:
	s.push(c)
	
while len(s) > 0:
	print(s.pop(), end='')
```

### queue 모듈의 LifoQueue 사용하기

파이썬에서는 queue 모듈에서 큐나 스택(LifoQueue), 우선순위큐(PriorityQueue) 등 클래스로 제공해 줍니다.

따라서 이 모듈의 LifoQueue를 이용하면 스택을 따로 구현하지 않고도 해결할 수 있습니다. 클래스 이름이 Stack이 아니라 LifoQueue인 것에 유의하세요.


```python
import queue

s = queue.LifoQueue(maxsize = 100)

msg = input()
for c in msg:
	s.put(c)
	
while not s.empty():
	print(s.get(), end='')
```
